# malimg-image-classification
Image-based malware classification using traditional ML models on the Malimg dataset


# Malware Image Classification using the Malimg Dataset

## Overview

This project focuses on the classification of malware samples using image-based representations of binary executable files. The **Malimg dataset** contains grayscale images generated by converting binary malware files into 2D images, where binary bits are mapped to pixel values: `1` → black pixel, `0` → white pixel.

The main objective is to **train and evaluate multiple machine learning models** on this dataset and compare their performance in malware family classification.

---

## Dataset: Malimg

- The Malimg dataset contains images of malware from different families.
- Each image is generated from a malware binary by converting its byte values to grayscale pixel intensities.
- The dataset is organized into subfolders where each folder corresponds to a malware class.
- Classes are fairly imbalanced, which should be considered when evaluating model performance.

---

## Task

- Preprocess the images: resize, convert to grayscale, and flatten.
- Encode class labels.
- Train the following classifiers:
  - **Naïve Bayes**
  - **K-Nearest Neighbors (KNN)**
  - **Random Forest**
  - **Logistic Regression**
- Evaluate each model using the following metrics:
  - **Accuracy**
  - **Precision**
  - **Recall**
  - **F1-Score**
- Provide analysis and comparison of results.

---

## Setup & Requirements

This project was developed using **Google Colab**. Key libraries used:

- `numpy`
- `pandas`
- `PIL` (Pillow)
- `scikit-learn`
- `kagglehub` (for dataset download)

You can install missing dependencies using:

```bash
pip install kagglehub
```

To use the Kaggle API for dataset download:

1. Download your `kaggle.json` from [Kaggle API page](https://www.kaggle.com/account).
2. Upload it to your Colab session before running the dataset download code.

---

## Data Preparation

- Images are loaded from `train/`, `test/`, and `val/` subdirectories.
- Each image is resized to `64x64` pixels and converted to grayscale.
- Flattened into 1D arrays to be used as feature vectors.
- Labels are extracted from folder names and encoded as integers.

---

## Models & Training

The following models are trained using the `scikit-learn` library:

1. **Naïve Bayes**
   - `GaussianNB()` is used.
   - Suitable for normally distributed features.

2. **K-Nearest Neighbors (KNN)**
   - `KNeighborsClassifier(n_neighbors=5)`
   - Classifies based on the majority vote of k closest data points.

3. **Random Forest**
   - `RandomForestClassifier(n_estimators=100, random_state=42)`
   - An ensemble method based on multiple decision trees.

4. **Logistic Regression**
   - `LogisticRegression(max_iter=1000)`
   - Uses a linear model with regularization for classification.

---

## Evaluation Metrics

Each model is evaluated using:

- **Accuracy**: Overall correctness of predictions.
- **Precision**: Correct positive predictions / Total positive predictions.
- **Recall**: Correct positive predictions / Total actual positives.
- **F1-Score**: Harmonic mean of precision and recall.

All metrics are computed **per class** and as **macro-averages** for comparison.

---

## Analysis

- Models like **Random Forest** and **Logistic Regression** typically perform better on structured features like pixel intensities.
- **KNN** may suffer from high dimensionality and noise.
- **Naïve Bayes** assumes independence and normal distribution, which might not hold for image data.
- Model selection can benefit from dimensionality reduction or feature engineering for further improvement.

---

## File Structure

- `HW2.ipynb`: Main Jupyter notebook containing the full implementation.
- `hw2.py`: Script version (automatically exported from Colab).
- `README.md`: This file.

---

## Notes

- Consider using dimensionality reduction techniques like PCA in future iterations.
- This dataset is suitable for deep learning models such as CNNs for better performance.
- Data augmentation was **not** used in this version.

---

## License

This project is for educational use. Dataset usage must comply with [Kaggle Terms of Service](https://www.kaggle.com/terms).
